/*! kiiri-angular-directives: Built on 2015-10-10 */
var autocomplete=angular.module("kiiri.angular.autocomplete",["kiiri.angular.clickoutside"]);autocomplete.controller("autocompleteController",["$scope","$http","$timeout","Helpers",function(a,b,c,d){"use strict";d.defaultValue(a,"isResultsHidden",!0),d.defaultValue(a,"numAutocompleting",0),d.defaultValue(a,"emailClicked",angular.noop),d.defaultValue(a,"searchClicked",angular.noop),d.defaultValue(a,"initialResults",[]),d.defaultValue(a,"isDisabled",!1),d.defaultValue(a,"onEnter",angular.noop),d.defaultValue(a,"searchEnabled",!1),d.defaultValue(a,"emailEnabled",!1),d.defaultValue(a,"method","POST"),d.defaultValue(a,"placeholder",""),a.latestResponse=new Date,a.$watch("search",function(){if(!a.disabled&&!a.isResultsHidden)if(a.search){a.numAutocompleting+=1;var c=new Date,d={};d[a.searchField]=a.search,a.authenticity_token&&(d.authenticity_token=a.authenticityToken),b({method:a.method,url:a.endpoint,data:d}).success(function(b){c>a.latestResponse&&(a.resultField?a.results=b[a.resultField]:a.results=b,a.latestResponse=c)}).error(function(a){})["finally"](function(){a.numAutocompleting-=1})}else a.results={items:a.initialResults}}),a.searchNotEmail=function(){return-1===a.search.indexOf("@")},a.clearDisabled=function(){a.isDisabled=!1,a.search="",c(function(){$("#"+a.identifier+" input").click(),$("#"+a.identifier+" input").focus()},10)},a.hideResults=function(){a.isResultsHidden=!0}}]),autocomplete.directive("autocomplete",[function(){"use strict";return{restrict:"E",templateUrl:"src/autocomplete/kiiri-autocomplete.tpl.html",scope:{search:"=?",placeholder:"@?",endpoint:"@",method:"@?",searchField:"@",resultField:"@?",results:"=?",resultClicked:"=",isResultsHidden:"=?",emailClicked:"=?",searchClicked:"=?",initialResults:"=?",isDisabled:"=?",onEnter:"=?",searchEnabled:"=?",emailEnabled:"=?",authenticityToken:"@?"},transclude:!0,controller:"autocompleteController"}}]),autocomplete.directive("autocompleteResult",[function(){"use strict";return{restrict:"A",link:function(a,b,c,d,e){var f=a.$parent.$parent.$new();f.result=a.$eval(c.result),e(f,function(a){b.append(a)})}}}]);var button=angular.module("kiiri.angular.button",[]);button.controller("buttonController",["$scope","Helpers",function(a,b){"use strict";b.defaultValue(a,"propagate",!1),a.onClick=function(b){a.propagate||b.stopPropagation(),a.disabled||a.loading||a.click()}}]),button.directive("angularButton",[function(){"use strict";return{restrict:"E",templateUrl:"src/button/kiiri-button.tpl.html",scope:{click:"&",loading:"=?",type:"@?",disabled:"=?",fill:"=?"},transclude:!0,controller:"buttonController"}}]);var checkbox=angular.module("kiiri.angular.checkbox",[]);checkbox.controller("checkboxController",["$scope","Helpers",function(a,b){"use strict";b.defaultValue(a,"identifier",b.guid())}]),checkbox.directive("checkbox",[function(){"use strict";return{restrict:"E",templateUrl:"src/checkbox/kiiri-checkbox.tpl.html",scope:{checked:"=",identifier:"=?"},transclude:!0,controller:"checkboxController"}}]);var clickOutside=angular.module("kiiri.angular.clickoutside",[]);clickOutside.directive("clickoutside",["$document","Helpers",function(a,b){"use strict";return{restrict:"A",scope:{onClickOutside:"=",isEnabled:"=?"},link:function(c,d,e){e.id?c.mainElementId=e.id:(c.mainElementId=b.guid(),$(d).attr("id",c.mainElementId));var f=function(a){if(c.isEnabled!==!1&&a&&a.target){for(var b=a.target;b;b=b.parentNode){var d=b.id;if(void 0!==d&&d===c.mainElementId)return}c.$apply(function(){c.onClickOutside()})}};a.on("click",f),c.$on("$destroy",function(){a.off("click",f)})}}}]);var dropdown=angular.module("kiiri.angular.dropdown",[]);dropdown.controller("dropdownController",["$scope","Helpers",function(a,b){"use strict";b.defaultValue(a,"items",[]),b.defaultValue(a,"previouslyResized",!1),a.itemDisplay=function(a){return angular.isObject(a)?a.name:a},a.itemValue=function(a){return angular.isObject(a)?a.value:a},a.selectItem=function(b){a.selectedItem=b,a.dropdownOpen=!1},a.toggleDropdown=function(){a.dropdownOpen=!a.dropdownOpen},a.closeDropdown=function(){a.dropdownOpen=!1}}]),dropdown.directive("dropdown",[function(){"use strict";return{restrict:"E",templateUrl:"src/dropdown/kiiri-dropdown.tpl.html",scope:{autoSelect:"=?",defaultText:"@?",disabled:"=?",emptyText:"@?",icon:"@?",formName:"@?",items:"=?",selectedItem:"=?"},controller:"dropdownController",link:function(a,b){a.$watch("items",function(c,d){if(a.autoSelect&&a.items.length>0?a.selectedItem&&c===d||(a.selectedItem=a.items[0]):a.selectedItem=null,!a.previouslyResized&&0===$(b).find(".kiiri-dropdown").width()||a.previouslyResized){var e=$(b).find("table").width();$(b).find(".kiiri-dropdown").width(e),a.previouslyResized=!0}},!0)}}}]);var imageInput=angular.module("kiiri.angular.imageinput",[]);imageInput.controller("imageInputController",["$scope","$timeout","$http","Helpers",function(a,b,c,d){"use strict";if(d.defaultValue(a,"onChange",angular.noop),a.defaultGradient){var e=152,f=225;a.gradientValues=[Math.floor(Math.random()*(f-e)+e),Math.floor(Math.random()*(f-e)+e),Math.floor(Math.random()*(f-e)+e)]}a.getFile=function(){return a.file},a.openImageInput=function(c){c.stopPropagation(),b(function(){a.loading||$(c.currentTarget).find("input[type='file']").click()},0)},a.fileChanged=function(c){b(function(){if(!a.loading){var b=new FileReader;a.autoLoading&&(a.loading=!0),b.onload=function(b){a.$apply(function(){a.value=b.target.result})},c&&c.files&&c.files.length>0&&a.$apply(function(){a.file=c.files[0],a.onChange(c.files[0])}),b.readAsDataURL(c.files[0])}},0)}}]),imageInput.directive("imageInput",[function(){"use strict";return{restrict:"E",templateUrl:"src/image-input/kiiri-image-input.tpl.html",scope:{value:"=?",getFile:"=?",onChange:"=?",loading:"=?",autoLoading:"=?",defaultGradient:"=?"},transclude:!0,controller:"imageInputController"}}]);var input=angular.module("kiiri.angular.input",[]);input.controller("inputController",["$scope","Helpers",function(a,b){"use strict";b.defaultValue(a,"fill",!1),b.defaultValue(a,"invalid",!1),b.defaultValue(a,"type","text"),b.defaultValue(a,"placeholder",""),b.defaultValue(a,"isDisabled",!1),b.defaultValue(a,"onEnter",angular.noop),a.defaultValue&&(a.value=a.defaultValue)}]),input.directive("inputField",[function(){"use strict";return{restrict:"E",templateUrl:"src/input-field/kiiri-input-field.tpl.html",scope:{defaultValue:"@?",isDisabled:"=?",fill:"=?",icon:"@?",invalid:"=?",name:"@?",placeholder:"@?",type:"@?",value:"=",onEnter:"=?"},controller:"inputController"}}]);var app=angular.module("kiiri.angular",["kiiri.angular.autocomplete","kiiri.angular.button","kiiri.angular.checkbox","kiiri.angular.clickoutside","kiiri.angular.dropdown","kiiri.angular.input","kiiri.angular.imageinput","kiiri.angular.modal","kiiri.angular.textarea","kiiri.angular.tooltip"]);app.service("Helpers",function(){this.defaultValue=function(a,b,c){a[b]||(a[b]=c)},this.guid=function(){function a(a){var b=(Math.random().toString(16)+"000000000").substr(2,8);return a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b}return a()+a(!0)+a(!0)+a()}});var modal=angular.module("kiiri.angular.modal",[]);modal.controller("modalController",["$scope","Helpers",function(a,b){"use strict";b.defaultValue(a,"closeCallback",angular.noop),b.defaultValue(a,"isOpen",!1),a.closeModal=function(){a.isOpen=!1,a.fadeOut=!0,a.closeCallback()}}]),modal.directive("modal",[function(){"use strict";return{restrict:"E",templateUrl:"src/modal/kiiri-modal.tpl.html",scope:{isOpen:"=",closeCallback:"=?",overflow:"=?"},transclude:!0,controller:"modalController",link:function(a,b){a.$watch("isOpen",function(c,d){var e=$(b).find(".modal-frame").width();$(".modal-frame").css("margin-left",-1*(e/2)),c!==d&&(a.fadeOut=!a.isOpen)})}}}]),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="monospaced.elastic"),angular.module("monospaced.elastic",[]).constant("msdElasticConfig",{append:""}).directive("msdElastic",["$timeout","$window","msdElasticConfig",function(a,b,c){"use strict";return{require:"ngModel",restrict:"A, C",link:function(d,e,f,g){function h(){var a=r;n=k,u=getComputedStyle(k),angular.forEach(C,function(b){a+=b+":"+u.getPropertyValue(b)+";"}),t.setAttribute("style",a)}function i(){var b,c,e,f,g;n!==k&&h(),o||(o=!0,t.value=k.value+p,t.style.overflowY=k.style.overflowY,b=""===k.style.height?"auto":parseInt(k.style.height,10),c=getComputedStyle(k).getPropertyValue("width"),"px"===c.substr(c.length-2,2)&&(f=parseInt(c,10)-x.width,t.style.width=f+"px"),e=t.scrollHeight,e>B?(e=B,g="scroll"):A>e&&(e=A),e+=x.height,k.style.overflowY=g||"hidden",b!==e&&(d.$emit("elastic:resize",l,b,e),k.style.height=e+"px"),a(function(){o=!1},1))}function j(){o=!1,i()}var k=e[0],l=e;if("TEXTAREA"===k.nodeName&&b.getComputedStyle){l.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var m=k.value;k.value="",k.value=m;var n,o,p=f.msdElastic?f.msdElastic.replace(/\\n/g,"\n"):c.append,q=angular.element(b),r="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",s=angular.element('<textarea aria-hidden="true" tabindex="-1" style="'+r+'"/>').data("elastic",!0),t=s[0],u=getComputedStyle(k),v=u.getPropertyValue("resize"),w="border-box"===u.getPropertyValue("box-sizing")||"border-box"===u.getPropertyValue("-moz-box-sizing")||"border-box"===u.getPropertyValue("-webkit-box-sizing"),x=w?{width:parseInt(u.getPropertyValue("border-right-width"),10)+parseInt(u.getPropertyValue("padding-right"),10)+parseInt(u.getPropertyValue("padding-left"),10)+parseInt(u.getPropertyValue("border-left-width"),10),height:parseInt(u.getPropertyValue("border-top-width"),10)+parseInt(u.getPropertyValue("padding-top"),10)+parseInt(u.getPropertyValue("padding-bottom"),10)+parseInt(u.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},y=parseInt(u.getPropertyValue("min-height"),10),z=parseInt(u.getPropertyValue("height"),10),A=Math.max(y,z)-x.height,B=parseInt(u.getPropertyValue("max-height"),10),C=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];l.data("elastic")||(B=B&&B>0?B:9e4,t.parentNode!==document.body&&angular.element(document.body).append(t),l.css({resize:"none"===v||"vertical"===v?"none":"horizontal"}).data("elastic",!0),"onpropertychange"in k&&"oninput"in k?k.oninput=k.onkeyup=i:k.oninput=i,q.bind("resize",j),d.$watch(function(){return g.$modelValue},function(a){j()}),d.$on("elastic:adjust",function(){h(),j()}),a(i),d.$on("$destroy",function(){s.remove(),q.unbind("resize",j)}))}}}}]);var textarea=angular.module("kiiri.angular.textarea",["monospaced.elastic"]);textarea.controller("textareaController",["$scope","Helpers",function(a,b){"use strict"}]),textarea.directive("textArea",[function(){"use strict";return{restrict:"E",templateUrl:"src/textarea/kiiri-text-area.tpl.html",scope:{fill:"=?",invalid:"=?",name:"@?",placeholder:"@?",value:"="},controller:"textareaController"}}]);var tooltip=angular.module("kiiri.angular.tooltip",[]);tooltip.controller("tooltipController",["$scope","Helpers",function(a,b){"use strict";b.defaultValue(a,"isVisible",!1),b.defaultValue(a,"isDisabled",!1),b.defaultValue(a,"position","bottom"),a.showTooltip=function(b){if(!a.isDisabled){var c=$(b.currentTarget).parent(),d=$(c).find(".tooltip-content");d.css("width",a.tooltipWidth+40),"bottom"===a.position?(d.css("left",b.pageX-$(c).offset().left-25),d.css("top",$(b.currentTarget).height()+12)):"right"===a.position&&d.css("left",$(b.currentTarget).width()+12),a.isVisible=!0}},a.hideTooltip=function(){a.isVisible=!1}}]),tooltip.directive("tooltip",[function(){"use strict";return{restrict:"E",templateUrl:"src/tooltip/kiiri-tooltip.tpl.html",scope:{text:"@",isVisible:"=?",isDisabled:"=?",position:"@?"},link:function(a,b,c){a.$watch("text",function(){a.tooltipWidth=$(b).find(".kiiri-tooltip-length-calculator").width()})},transclude:!0,controller:"tooltipController"}}]),angular.module("kiiri.angular").run(["$templateCache",function(a){"use strict";a.put("src/autocomplete/kiiri-autocomplete.tpl.html",'<div class="kiiri-autocomplete" clickoutside on-click-outside="hideResults"><input-field type="text" value="search" placeholder="{{placeholder}}" ng-click="!isDisabled && (isResultsHidden = false)" is-disabled="isDisabled" on-enter="onEnter" fill="true"></input-field><div class="disabled-button" ng-if="isDisabled" ng-click="clearDisabled()">x</div><div class="loading-spinner" ng-if="numAutocompleting > 0"><i class="fa fa-refresh fa-spin"></i></div><div class="kiiri-autocomplete-results" ng-show="!isResultsHidden"><div class="kiiri-autocomplete-item" ng-repeat="item in results"><div class="kiiri-autocomplete-result" autocomplete-result result="item"></div></div><div class="kiiri-autocomplete-result" ng-show="search && searchNotEmail() && searchEnabled" ng-click="searchClicked()"><img class="kiiri-autocomplete-image" src="<%= asset_path \'icons/icon-search-999.png\' %>">Find "{{search}}" on GymFlash</div><div class="kiiri-autocomplete-result" ng-show="search && !searchNotEmail() && emailEnabled" ng-click="emailClicked()"><img class="kiiri-autocomplete-image" src="<%= asset_path \'icons/icon-envelope-999.png\' %>">Invite "{{search}}"</div></div></div>'),a.put("src/button/kiiri-button.tpl.html",'<div class="kiiri-button" ng-class="{ grey: type === \'grey\', disabled: disabled, loading: loading, fill: fill }" ng-click="onClick($event)"><span ng-transclude></span><i class="fa fa-refresh fa-spin" ng-if="loading"></i></div>'),a.put("src/checkbox/kiiri-checkbox.tpl.html",'<div class="kiiri-checkbox"><input id="{{identifier}}" type="checkbox" ng-model="checked"><label for="{{identifier}}"><span ng-transclude></span></label></div>'),a.put("src/dropdown/kiiri-dropdown.tpl.html",'<div class="kiiri-dropdown" ng-click="toggleDropdown()" clickoutside on-click-outside="closeDropdown" is-enabled="dropdownOpen" ng-class="{ empty: (items.length === 0), disabled: disabled, open: dropdownOpen }"><table ng-class="{ open: dropdownOpen }"><tr><td><div class="kiiri-dropdown-current-item" ng-style="{\'background-image\': (icon && \'url(\'+icon+\')\')}" ng-class="{ \'has-icon\': icon, empty: (items.length === 0), disabled: disabled }">{{ itemDisplay(selectedItem) || (items.length === 0 && emptyText) || defaultText }}</div></td></tr><tr><td><div class="kiiri-dropdown-items" ng-class="{ visible: dropdownOpen }"><div class="kiiri-dropdown-item" ng-repeat="item in items" ng-class="{ \'has-icon\': icon }" ng-click="selectItem(item); $event.stopPropagation()">{{itemDisplay(item)}}</div></div></td></tr></table><input ng-if="formName" name="{{formName}}" value="{{ itemValue(selectedItem) }}"></div>'),a.put("src/image-input/kiiri-image-input.tpl.html",'<div class="kiiri-image-input" style="background-image: url(\'{{value}}\')"><div class="gradient-overlay" ng-if="defaultGradient && !value" style="background: linear-gradient(to bottom, rgba({{gradientValues[0]}},{{gradientValues[1]}},{{gradientValues[2]}},1), rgba({{gradientValues[0]-100}},{{gradientValues[1]-100}},{{gradientValues[2]-100}},1))"></div><div class="image-text" ng-if="!value" ng-transclude></div><input type="file" onchange="angular.element(this).scope().fileChanged(this)"><div class="opacity-overlay" ng-if="loading"></div><div class="spinner-overlay" ng-if="loading"><div class="spinner-wrapper"><i class="fa fa-refresh fa-spin"></i></div></div></div>'),a.put("src/input-field/kiiri-input-field.tpl.html",'<div class="kiiri-input-field" ng-class="{ fill: fill }"><img ng-src="{{icon}}" ng-if="icon"><input type="{{type}}" placeholder="{{placeholder}}" name="{{name}}" ng-model="value" ng-class="{ invalid: invalid, \'has-icon\': icon }" ng-disabled="isDisabled" ng-enter="onEnter()"></div>'),a.put("src/modal/kiiri-modal.tpl.html",'<div class="kiiri-modal" ng-cloak><div class="modal-frame not-visible" ng-class="{ visible: isOpen, \'fade-in\': isOpen, \'fade-out\': fadeOut }"><div class="modal-body" ng-class="{\'overflow-inherit\': overflow === \'inherit\'}" clickoutside is-enabled="isOpen" on-click-outside="closeModal" ng-transclude></div></div><div ng-show="isOpen" class="modal-background ng-hide"></div></div>'),a.put("src/textarea/kiiri-text-area.tpl.html",'<div class="kiiri-text-area" ng-class="{ fill: fill }"><textarea ng-model="value" placeholder="{{placeholder}}" name="{{name}}" msd-elastic ng-class="{ invalid: invalid }"></textarea></div>'),a.put("src/tooltip/kiiri-tooltip.tpl.html",'<div class="kiiri-tooltip"><div class="tooltip-hover" ng-mouseover="showTooltip($event)" ng-mouseout="hideTooltip()" ng-transclude></div><div class="tooltip-content {{position}}" ng-class="{ visible: isVisible }">{{ text }}</div></div><div class="kiiri-tooltip-length-calculator">{{ text }}</div>')}]);